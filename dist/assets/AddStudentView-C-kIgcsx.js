import{u as j,H,D as R,s as y,r as m,$,f as o,j as p,d as s,l as x,w as k,g as n,F as b,G as w,b as l,t as i,c as D,z as S,n as C,B as T}from"./index-BEcAhmBe.js";import{_ as U}from"./TheBreadcrumb-Bryl08sX.js";import{c as N,d as A,F as G,b as O}from"./index.esm-DoS_w8Tg.js";const I={class:"w-full rounded-lg shadow-lg p-4 bg-white dark:bg-[#171131ef]"},P={class:"w-full flex"},q={class:"w-full"},J=["value"],K={key:1,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",class:"w-12 h-6",version:"1.1",id:"Capa_1",viewBox:"0 0 26 26","xml:space":"preserve"},Q={class:"invalid-feedback select-none text-red-500 my-2 text-sm"},W={class:"mb-4"},X={key:0,class:"text-red-500 text-sm select-none"},Y={class:"flex flex-wrap justify-center md:justify-end lg:justify-end"},Z=["disabled"],ee={key:0,class:"text-center text-red-500 mt-3 mb-0 text-sm select-none"},se={key:0,class:"space-y-4"},te={class:"text-red-500 select-none"},de={__name:"AddStudentView",setup(le){const f=j(),c=H(),r=R(),{createSessionMistakes:_,createSessionStatus:V}=y(r),{highSchoolsResponse:z}=y(c),h=m(0),v=m(null),u=m(null);m(!1);const L=N().shape({high_school:A()}),E=a=>{v.value=a.target.files[0]};function F(){f.isLoading=!0,r.getForm(h.value,10).then(()=>{const a=new Blob([r.excelForm],{type:r.excelFormContentType});console.log(a);const e=URL.createObjectURL(a),t=document.createElement("a");t.href=e,t.target="_blank",t.download="form.xlsx",t.classList.add("hidden"),document.body.appendChild(t),t.click(),document.body.removeChild(t),r.resetExcelFormStates(),f.isLoading=!1})}const M=async a=>{if(v.value!==null){u.value=null;const e=new FormData;return e.append("excel",v.value),e.append("high_school_id",a.high_school),r.create(e).then(()=>{V.value&&T.push("/students")}).catch(t=>{setErrors({apiError:t})})}else u.value="Excel faýlyny hökmän girizmeli"};$(()=>{c.getAll().then(()=>{c.highSchoolsResponse.length!=0&&(h.value=c.highSchoolsResponse[0].id)})});const B=[{path:"/students",name:"Talyplar"},{path:"/students/add",name:"Goşmak"}];return(a,e)=>(l(),o(b,null,[p(U,{paths:B}),s("div",I,[e[5]||(e[5]=s("h3",{class:"text-xl font-bold mx-2 select-none"},"Talyplary hasaba almak",-1)),p(n(G),{onSubmit:M,"validation-schema":n(L),"initial-values":{high_school:0},class:"space-y-4 my-4"},{default:k(({errors:t,isSubmitting:g,values:oe})=>[s("div",P,[s("div",q,[p(n(O),{as:"select",name:"high_school",id:"high_school",modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=d=>h.value=d),class:"w-full border border-gray-300 dark:border-gray-700 rounded-l-md p-2 focus:outline-none select-none"},{default:k(()=>[(l(!0),o(b,null,w(n(z),d=>(l(),o("option",{class:"text-gray-600 dark:bg-[#171131ef] dark:text-white select-none",value:d.id},i(d.name),9,J))),256))]),_:1},8,["modelValue"])]),s("div",null,[s("button",{onClick:F,class:"btn-active rounded-e-md h-full px-2 lg:px-6"},[n(f).isLoading?(l(),D(S,{key:0})):(l(),o("svg",K,e[2]||(e[2]=[s("g",null,[s("path",{fill:"currentColor",d:"M25.162,3H16v2.984h3.031v2.031H16V10h3v2h-3v2h3v2h-3v2h3v2h-3v3h9.162   C25.623,23,26,22.609,26,22.13V3.87C26,3.391,25.623,3,25.162,3z M24,20h-4v-2h4V20z M24,16h-4v-2h4V16z M24,12h-4v-2h4V12z M24,8   h-4V6h4V8z"}),s("path",{fill:"currentColor",d:"M0,2.889v20.223L15,26V0L0,2.889z M9.488,18.08l-1.745-3.299c-0.066-0.123-0.134-0.349-0.205-0.678   H7.511C7.478,14.258,7.4,14.494,7.277,14.81l-1.751,3.27H2.807l3.228-5.064L3.082,7.951h2.776l1.448,3.037   c0.113,0.24,0.214,0.525,0.304,0.854h0.028c0.057-0.198,0.163-0.492,0.318-0.883l1.61-3.009h2.542l-3.037,5.022l3.122,5.107   L9.488,18.08L9.488,18.08z"})],-1)])))])])]),s("div",Q,i(t.high_school),1),s("div",null,[s("div",W,[e[3]||(e[3]=s("label",{for:"file",class:"block mb-1 select-none"},"Excel",-1)),s("input",{type:"file",id:"file",name:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:e[1]||(e[1]=d=>E(d)),class:"block w-full px-4 py-2 border-gray-300 dark:border-gray-600text-sm border rounded-md cursor-pointer bg-transparent focus:outline-none dark:placeholder-gray-400"},null,32),u.value?(l(),o("p",X,i(u.value),1)):x("",!0)])]),s("div",Y,[s("button",{disabled:g,class:"flex w-50 px-4 py-2 my-2 justify-center rounded-lg border-none dark:border-violet-500/50 border-1 bg-gradient-to-r from-blue-400 to-blue-500 dark:from-violet-600 dark:to-violet-500 text-white hover:shadow-lg hover:shadow-blue-300/50 hover:ease-in ease-out duration-200 dark:hover:shadow-violet-500/50 select-none"},[p(S,{class:C({hidden:!g})},null,8,["class"]),s("span",{class:C({hidden:g})},"Hasaba al",2)],8,Z)]),t.apiError?(l(),o("div",ee,i(t.apiError),1)):x("",!0)]),_:1},8,["validation-schema"]),n(_).length>0?(l(),o("div",se,[e[4]||(e[4]=s("h3",{class:"text-xl font-bold text-red-500 select-none"},"Üstünlikli ýüklenildi, emma käbir setirlerde näsazlyk ýüze çykdy",-1)),(l(!0),o(b,null,w(n(_),t=>(l(),o("p",te,i(t),1))),256))])):x("",!0)])],64))}};export{de as default};
